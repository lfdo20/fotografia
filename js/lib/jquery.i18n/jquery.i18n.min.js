/*!
 * jQuery Internationalization library
 *
 * Copyright (C) 2012 Santhosh Thottingal
 *
 * jquery.i18n is dual licensed GPLv2 or later and MIT. You don't have to do
 * anything special to choose one license or the other and you don't have to
 * notify anyone which license you are using. You are free to use
 * UniversalLanguageSelector in commercial projects as long as the copyright
 * header is left intact. See files GPL-LICENSE and MIT-LICENSE for details.
 *
 * @licence GNU General Public Licence 2.0 or later
 * @licence MIT License
 */
(function(b){var d,a,c=Array.prototype.slice;a=function(e){this.options=b.extend({},a.defaults,e);this.parser=this.options.parser;this.locale=this.options.locale;this.messageStore=this.options.messageStore;this.languages={};this.init()};a.prototype={init:function(){var e=this;String.locale=e.locale;String.prototype.toLocaleString=function(){var h,i,k,g,l,f,j;k=this.valueOf();g=e.locale;l=0;while(g){h=g.split("-");i=h.length;do{f=h.slice(0,i).join("-");j=e.messageStore.get(f,k);if(j){return j}i--}while(i);if(g==="en"){break}g=(b.i18n.fallbacks[e.locale]&&b.i18n.fallbacks[e.locale][l])||e.options.fallbackLocale;b.i18n.log("Trying fallback locale for "+e.locale+": "+g+" ("+k+")");l++}return""}},destroy:function(){b.removeData(document,"i18n")},load:function(g,e){var j,h,f,i={};if(!g&&!e){g="i18n/"+b.i18n().locale+".json";e=b.i18n().locale}if(typeof g==="string"&&g.split(".").pop()!=="json"){i[e]=g+"/"+e+".json";j=(b.i18n.fallbacks[e]||[]).concat(this.options.fallbackLocale);for(h=0;h<j.length;h++){f=j[h];i[f]=g+"/"+f+".json"}return this.load(i)}else{return this.messageStore.load(g,e)}},parse:function(e,g){var f=e.toLocaleString();this.parser.language=b.i18n.languages[b.i18n().locale]||b.i18n.languages["default"];if(f===""){f=e}return this.parser.parse(f,g)}};b.i18n=function(f,i){var g,h=b.data(document,"i18n"),e=typeof f==="object"&&f;if(e&&e.locale&&h&&h.locale!==e.locale){String.locale=h.locale=e.locale}if(!h){h=new a(e);b.data(document,"i18n",h)}if(typeof f==="string"){if(i!==undefined){g=c.call(arguments,1)}else{g=[]}return h.parse(f,g)}else{return h}};b.fn.i18n=function(){var e=b.data(document,"i18n");if(!e){e=new a();b.data(document,"i18n",e)}String.locale=e.locale;return this.each(function(){var j=b(this),h=j.data("i18n"),k,i,g,f;if(h){k=h.indexOf("[");i=h.indexOf("]");if(k!==-1&&i!==-1&&k<i){g=h.slice(k+1,i);f=h.slice(i+1);if(g==="html"){j.html(e.parse(f))}else{j.attr(g,e.parse(f))}}else{j.text(e.parse(h))}}else{j.find("[data-i18n]").i18n()}})};String.locale=String.locale||b("html").attr("lang");if(!String.locale){if(typeof window.navigator!==undefined){d=window.navigator;String.locale=d.language||d.userLanguage||""}else{String.locale=""}}b.i18n.languages={};b.i18n.messageStore=b.i18n.messageStore||{};b.i18n.parser={parse:function(f,e){return f.replace(/\$(\d+)/g,function(i,h){var g=parseInt(h,10)-1;return e[g]!==undefined?e[g]:"$"+h})},emitter:{}};b.i18n.fallbacks={};b.i18n.debug=false;b.i18n.log=function(){if(window.console&&b.i18n.debug){window.console.log.apply(window.console,arguments)}};a.defaults={locale:String.locale,fallbackLocale:"en",parser:b.i18n.parser,messageStore:b.i18n.messageStore};b.i18n.constructor=a}(jQuery));